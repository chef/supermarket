#!/usr/bin/env sh
set -e

export SUPERMARKET_PATH=$(cd "$(dirname "$0")/.." && pwd)
export SUPERMARKET_EXEC="$SUPERMARKET_PATH/exec"
export PATH="$SUPERMARKET_EXEC:$PATH"


###
# Dispatcher
###
command="$1"
case "$command" in
  "" | "-h" | "--help" )
    exec supermarket-help
    ;;
  * )
    command_path=$(command -v "supermarket-$command" || true)
    if [ ! -x "$command_path" ]; then
      echo "Supermarket: no such command \`$command\`" >&2
      exit 1
    fi

    shift
    exec "$command_path" "$@"
    ;;
esac
